* Benchmarks for WRF
This repo contains benchmark cases used for assessing the scaling performance of
WRF on NCAR's Cheyenne Supercomputer.

Each directory contains the namelists for WPS and WRF necessary for running the
case.

The Katrina data can be downloaded using curl from the WRF tutorial page

#+begin_src sh
curl http://www2.mmm.ucar.edu/wrf/TUTORIAL_DATA/Katrina.tar.gz -o Katrina.tar.gz
tar -xf Katrina.tar
#+end_src

The ~scripts~ directory contains useful shell scripts for creating the run
directory for each case and linking all the necessary data files and executable.

For example to run the ~katrina-3km~ case:
- Compile WRF and WPS
- Edit the top of the ~link_katrina~ script:
  - Provide the correct paths to the ~RUN_DIR~, ~DATA_DIR~, ~SCRIPTS_DIR~,
    ~WPS_DIR~ ~WRF_DIR~, ~NAMELIST_DIR~.
- Run ~link_katrina 3km~
- Change to the ~$RUN_DIR~
- Execute ~./run_wps~
- Submit the job with ~qsub cheyenne_real_and_wrf.sh~

#+begin_src sh
# compile 15 = dmpar - INTEL (ifort/icc)
# nest 1 = basic

wrf_compile \
    --source ~wrfhelp/SOURCE_CODE/WRFV3.8.1.TAR.gz\
    --wrfdir ~/work/WRFs/WRFV3.9.1.1-intel-dmpar-mpt2.18 \
    --compile 15 \
    --nest 1 \
    --mpiexec mpiexec_mpt \
    --modules \
    ncarenv/1.2 \
    intel/18.0.1 \
    ncarcompilers/0.4.1 \
    mpt/2.18 \
    netcdf/4.6.0
#+end_src

#+begin_src sh
export PATH=/glade/u/apps/ch/opt/mvapich2/2.2/gnu/7.1.0/bin/:$PATH

wrf_compile \
    --source ~wrfhelp/SOURCE_CODE/WRFV3.8.1.TAR.gz\
    --outdir ~/work/WRFs/WRFV3.9.1.1-intel-dmpar-mpt2.18 \
    --compile 15 \
    --nest 1 \
    --mpiexec "mpirun_rsh -hostfile $PBS_NODEFILE -n $1"  \
    --modules \
    ncarenv/1.2 \
    intel/18.0.1 \
    ncarcompilers/0.4.1 \
    mpt/2.18 \
    netcdf/4.6.0

#+end_src
